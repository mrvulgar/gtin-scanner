# 🔍 GTIN Scanner Live

**Профессиональное веб-приложение для извлечения Data Matrix кодов из PDF файлов с живым отображением прогресса.**

---

## 🎯 Возможности

- ✅ **Извлечение Data Matrix кодов** из многостраничных PDF документов
- ✅ **Живой прогресс** - обновление каждые 2 секунды в реальном времени
- ✅ **Выбор области сканирования** - точное выделение области с кодом
- ✅ **Гибкая настройка** - возможность ограничить количество обрабатываемых страниц
- ✅ **Экспорт в CSV** - удобный формат для дальнейшей обработки
- ✅ **Подробное логирование** - полная история работы приложения
- ✅ **Два варианта развертывания** - Desktop и IIS Server

---

## 📦 Варианты установки

### 🖥️ Windows Desktop (рекомендуется для личного использования)

Автономное приложение для Windows с простой установкой через инсталлятор.

**Преимущества:**
- Простая установка одним кликом
- Не требует настройки сервера
- Работает локально на вашем компьютере

**[📖 Подробная инструкция →](README_Windows_Desktop.md)**

---

### 🌐 IIS Web Server (для корпоративного использования)

Развертывание на веб-сервере IIS для доступа через браузер из любой точки сети.

**Преимущества:**
- Централизованный доступ
- Поддержка множества пользователей
- Интеграция с корпоративной инфраструктурой

**[📖 Подробная инструкция →](README_IIS_Deployment.md)**

---

## 🚀 Быстрый старт

### Вариант 1: Установка Desktop приложения

```cmd
# 1. Скачайте инсталлятор из папки installer_output/
# 2. Запустите GTIN_Scanner_Live_Setup.exe
# 3. Следуйте инструкциям мастера установки
# 4. Запустите приложение из меню "Пуск"
```

### Вариант 2: Развертывание на IIS

```powershell
# 1. Распакуйте GTIN_Scanner_IIS_Package.zip на сервере
# 2. Откройте PowerShell от имени администратора
# 3. Перейдите в папку с файлами
cd C:\path\to\extracted\files
# 4. Запустите развертывание
.\deploy_iis.bat
# 5. Откройте браузер
http://localhost
```

### Вариант 3: Локальный запуск для разработки

```bash
# 1. Клонируйте репозиторий
git clone <repository-url>
cd gtin-csv

# 2. Создайте виртуальное окружение
python -m venv venv

# 3. Активируйте окружение
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# 4. Установите зависимости
pip install -r requirements.txt

# 5. Запустите приложение
python gtin_scanner_live.py
```

Приложение будет доступно по адресу: `http://127.0.0.1:7860`

---

## 📖 Как пользоваться

1. **Загрузите PDF файл** - нажмите кнопку и выберите PDF
2. **Выделите область** - дважды кликните на превью для выбора области с Data Matrix кодом
3. **Настройте параметры** - укажите максимальное количество страниц (0 = все)
4. **Запустите сканирование** - нажмите кнопку и наблюдайте за прогрессом
5. **Скачайте результат** - получите CSV файл со всеми найденными кодами

---

## 📋 Системные требования

### Desktop версия
- **ОС:** Windows 10/11 (64-bit)
- **RAM:** 4 GB (рекомендуется 8 GB)
- **Процессор:** Intel Core i3 или аналогичный
- **Место на диске:** 500 MB

### IIS версия
- **ОС:** Windows Server 2016+ или Windows 10/11 Pro
- **IIS:** 10.0+
- **RAM:** 8 GB (рекомендуется 16 GB)
- **Процессор:** 2+ ядра
- **Место на диске:** 2 GB

### Общие требования
- **Python:** 3.8 или выше
- **HttpPlatformHandler v2** (только для IIS)
- **URL Rewrite Module** (только для IIS)

---

## 📚 Документация

| Файл | Описание |
|------|----------|
| [README.md](README.md) | Главная страница (вы здесь) |
| [README_Installation.md](README_Installation.md) | Общее руководство по установке |
| [README_Windows_Desktop.md](README_Windows_Desktop.md) | Подробная инструкция Desktop версии |
| [README_IIS_Deployment.md](README_IIS_Deployment.md) | Подробная инструкция IIS развертывания |
| [README_Windows.md](README_Windows.md) | Краткое руководство пользователя |
| [RELEASE_NOTES.md](RELEASE_NOTES.md) | Заметки о релизе |

---

## 🔧 Для разработчиков

### Структура проекта

```
gtin-csv/
├── gtin_scanner_live.py          # Основное приложение (Gradio)
├── gtin_scanner_live_iis.py      # IIS ASGI адаптер
├── requirements.txt               # Python зависимости
│
├── Windows Desktop:
│   ├── build_windows.spec         # PyInstaller конфигурация
│   ├── build_windows.bat          # Скрипт сборки exe
│   ├── setup_windows.iss          # Inno Setup скрипт
│   └── create_installers.bat      # Мастер создания инсталляторов
│
├── IIS Server:
│   ├── web.config                 # Конфигурация IIS
│   ├── deploy_iis.ps1             # PowerShell скрипт развертывания
│   └── deploy_iis.bat             # Batch обертка
│
└── Документация:
    ├── README.md                  # Главная страница
    ├── README_Installation.md     # Общая инструкция
    ├── README_Windows_Desktop.md  # Desktop инструкция
    ├── README_IIS_Deployment.md   # IIS инструкция
    ├── README_Windows.md          # Руководство пользователя
    └── RELEASE_NOTES.md           # Заметки о релизе
```

### Зависимости

```txt
gradio>=4.0.0          # Web UI framework
PyMuPDF>=1.23.0        # PDF processing
pylibdmtx>=0.1.10      # Data Matrix decoder
Pillow>=10.0.0         # Image processing
numpy>=1.24.0          # Numerical operations
uvicorn>=0.24.0        # ASGI server (для IIS)
fastapi>=0.104.0       # Web framework (для IIS)
```

### Создание инсталляторов

```cmd
# Создать все инсталляторы одной командой
create_installers.bat

# Результаты:
# - installer_output/GTIN_Scanner_Live_Setup.exe   (Desktop инсталлятор)
# - package_output/GTIN_Scanner_IIS_Package.zip     (IIS пакет)
```

### API приложения

```python
from gtin_scanner_live import GTINScanner

# Создание экземпляра
scanner = GTINScanner()

# Загрузка PDF
preview, status = scanner.load_pdf_preview(pdf_file)

# Установка области обрезки
scanner.crop_rect = (x1, y1, x2, y2)

# Сканирование с прогрессом
scanner.scan_pdf_with_live_progress(max_pages=50)

# Получение текущего прогресса
status, stats, page_info, csv_file = scanner.get_live_progress()
```

---

## 🎨 Скриншоты

### Главный интерфейс
```
┌─────────────────────────────────────────────────────────┐
│ GTIN Scanner Live - Data Matrix Scanner                │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  [📁 Загрузите PDF файл]                               │
│                                                         │
│  ┌───────────────────────────┐  ┌──────────────────┐  │
│  │                           │  │ Выделение области│  │
│  │   Превью страницы PDF     │  │ Кликните дважды  │  │
│  │   (интерактивное)         │  │                  │  │
│  │                           │  │ Настройки:       │  │
│  │                           │  │ Макс. страниц: 50│  │
│  │                           │  │                  │  │
│  │                           │  │ [⚡ Начать]      │  │
│  │                           │  │ [⏹ Остановить]  │  │
│  └───────────────────────────┘  │                  │  │
│                                  │ Прогресс: 10/50  │  │
│  Статус: Готов к работе         │ Кодов: 125       │  │
│                                  │ Время: 45.2с     │  │
│                                  │                  │  │
│                                  │ [💾 Скачать CSV] │  │
│                                  └──────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 Производительность

Время обработки зависит от размера PDF и мощности системы:

| Страниц | Примерное время |
|---------|-----------------|
| 10      | ~30 секунд      |
| 50      | ~2-3 минуты     |
| 100     | ~5-7 минут      |
| 500     | ~25-35 минут    |

**Рекомендации:**
- Начинайте с малого количества страниц для тестирования
- Выделяйте только область с Data Matrix кодом
- Используйте SSD для более быстрой работы

---

## 🐛 Известные проблемы и решения

### Desktop версия

**Проблема:** Windows Defender блокирует запуск

**Решение:** Добавьте исключение в Windows Defender или запустите от имени администратора

---

**Проблема:** Порт 7860 уже занят

**Решение:** Измените порт в `gtin_scanner_live.py` или закройте другие приложения

---

### IIS версия

**Проблема:** Ошибка 500 Internal Server Error

**Решение:** Проверьте логи в `logs/stdout.log` и убедитесь, что:
- Python установлен правильно
- Все зависимости установлены
- Application Pool имеет права на папку

---

**Проблема:** WebSocket не работает

**Решение:** Установите URL Rewrite Module и убедитесь, что WebSocket включен в IIS

---

## 🔒 Безопасность

### Desktop
- Приложение работает локально
- Данные не передаются в интернет
- PDF обрабатываются на вашем компьютере

### IIS
- **Используйте HTTPS** для защиты данных
- **Настройте файрвол** для ограничения доступа
- **Регулярно обновляйте** зависимости
- **Мониторьте логи** для выявления проблем

---

## 🔄 Обновления

### Desktop
1. Скачайте новый инсталлятор
2. Запустите его (старая версия будет обновлена)

### IIS
1. Остановите сайт: `Stop-Website -Name "GTIN-Scanner"`
2. Обновите файлы
3. Обновите зависимости: `pip install -r requirements.txt --upgrade`
4. Запустите сайт: `Start-Website -Name "GTIN-Scanner"`

---

## 🤝 Вклад в проект

Мы приветствуем вклад в развитие проекта!

### Как внести вклад:

1. Fork репозитория
2. Создайте ветку для ваших изменений
3. Внесите изменения и протестируйте
4. Создайте Pull Request

### Что можно улучшить:

- Поддержка других типов кодов (QR, штрих-коды)
- Улучшение производительности
- Дополнительные форматы экспорта
- Улучшение документации
- Перевод на другие языки

---

## 📝 История изменений

См. [RELEASE_NOTES.md](RELEASE_NOTES.md)

---

## 📄 Лицензия

© 2024 Your Company. Все права защищены.

---

## 📞 Контакты и поддержка

**Документация:**
- [Общая инструкция](README_Installation.md)
- [Desktop версия](README_Windows_Desktop.md)
- [IIS версия](README_IIS_Deployment.md)

**Для получения помощи:**
1. Проверьте раздел "Устранение проблем" в соответствующей документации
2. Посмотрите логи приложения
3. Обратитесь к администратору системы

---

## 🙏 Благодарности

Проект использует следующие open-source библиотеки:
- [Gradio](https://gradio.app/) - Web UI framework
- [PyMuPDF](https://pymupdf.readthedocs.io/) - PDF processing
- [pylibdmtx](https://github.com/NaturalHistoryMuseum/pylibdmtx) - Data Matrix decoder
- [Pillow](https://python-pillow.org/) - Image processing

Спасибо всем разработчикам этих замечательных библиотек!

---

<div align="center">

**⭐ Если проект вам помог, поставьте звезду! ⭐**

Made with ❤️ 

</div>

